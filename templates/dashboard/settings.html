{% extends "dashboard/base.html" %}

{% block title %}Settings{% endblock %}

{% block content %}
    <div class="mx-auto">
        <h2 class="text-3xl font-bold mb-8">Profile Settings</h2>

        <!-- Profile Update Form -->
        <form class="grid md:grid-cols-3 gap-6" action="" method="POST" enctype="multipart/form-data">
            {% csrf_token %}

            <!-- LEFT: Profile Image -->
            <div class="bg-white p-6 rounded-xl shadow">
                <div class="flex flex-col items-center">
                    {% if form.instance.profile_image %}
                        <img
                                src="{{ form.instance.profile_image.url }}"
                                class="w-32 h-32 rounded-full object-cover shadow mb-4"
                                alt="Profile Image"
                        >
                    {% else %}
                        <div class="w-32 aspect-square rounded-full bg-gray-200 overflow-hidden p-2">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640">
                                <path d="M320 312C386.3 312 440 258.3 440 192C440 125.7 386.3 72 320 72C253.7 72 200 125.7 200 192C200 258.3 253.7 312 320 312zM290.3 368C191.8 368 112 447.8 112 546.3C112 562.7 125.3 576 141.7 576L498.3 576C514.7 576 528 562.7 528 546.3C528 447.8 448.2 368 349.7 368L290.3 368z"/>
                            </svg>
                        </div>
                    {% endif %}

                    <label class="block mt-4 w-full">
                        <span class="text-sm font-medium">Change Photo</span>
                        {{ form.profile_image }}
                    </label>
                </div>
            </div>

            <!-- RIGHT: Profile Fields -->
            <div class="md:col-span-2 bg-white p-6 rounded-xl shadow">
                <h3 class="text-xl font-semibold mb-4">Account Information</h3>

                <div class="flex gap-4 mb-4">
                    <div class="flex-1">
                        <label for="{{ form.first_name.id_for_label }}" class="block text-sm font-medium mb-1">First
                            Name</label>
                        <input
                                type="text"
                                name="{{ form.first_name.name }}"
                                value="{{ form.instance.first_name }}"
                                class="w-full border border-gray-300 p-2 rounded-lg focus:ring focus:ring-blue-200"
                        >
                    </div>

                    <div class="flex-1">
                        <label for="{{ form.last_name.id_for_label }}" class="block text-sm font-medium mb-1">Last
                            Name</label>
                        <input
                                type="text"
                                name="{{ form.last_name.name }}"
                                value="{{ form.instance.last_name }}"
                                class="w-full border border-gray-300 p-2 rounded-lg focus:ring focus:ring-blue-200"
                        >
                    </div>
                </div>

                <!-- Email -->
                <div class="mb-6">
                    <label class="block text-sm font-medium mb-1">Email</label>
                    <p class="w-full p-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-700">
                        {{ user.email }}
                    </p>
                </div>

                <button
                        type="submit"
                        class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">
                    Save Changes
                </button>
            </div>
        </form>

        <!-- Password Change Section -->
        <div class="bg-white p-6 rounded-xl shadow mt-10">
            <h3 class="text-xl font-semibold mb-4">Security</h3>

            <p class="text-gray-600 mb-4">
                To update your password, use the secure password change page powered by django-allauth.
            </p>

            <a
                    href="{% url 'account_change_password' %}"
                    class="inline-block bg-gray-800 text-white px-6 py-2 rounded-lg hover:bg-black"
            >
                Change Password
            </a>
        </div>
    </div>
{% endblock %}
